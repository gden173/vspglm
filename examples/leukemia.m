clc;clear;rehash;
% Add the function to path
addpath(genpath('C:\Users\gabri\Dropbox\sem2_2020\honours\code\vspglm\src'))
%% LEUKEMIA SURVIVAL TIMES from Davison and Hinkley (1997)
x1 =[1 0 3.36 0;
     1 0 2.88 0;
     1 0 3.63 0;
     1 0 3.41 0;
     1 0 3.78 0;
     1 0 4.02 0;
     1 0 4.00 0;
     1 0 4.23 0;
     1 0 3.73 0;
     1 0 3.85 0;
     1 0 3.97 0;
     1 0 4.51 0;
     1 0 4.54 0;
     1 0 5.00 0;
     1 0 5.00 0;
     1 0 4.72 0;
     1 0 5.00 0;
     1 1 3.64 3.64;
     1 1 3.48 3.48;
     1 1 3.60 3.60;
     1 1 3.18 3.18;
     1 1 3.95 3.95;
     1 1 3.72 3.72;
     1 1 4.00 4.00;
     1 1 4.28 4.28;
     1 1 4.43 4.43;
     1 1 4.45 4.45;
     1 1 4.49 4.49;
     1 1 4.41 4.41;
     1 1 4.32 4.32;
     1 1 4.90 4.90;
     1 1 5.00 5.00;
     1 1 5.00 5.00] ;
 
 y = [65; 156; 100; 134; 16; 108; 121; 4; 39; 143; 56; 26; 22; 1; 1; 5;
     65; 56; 65; 17; 7; 16; 22; 3; 4; 2; 3; 8; 4;3; 30; 4; 43];
leuk_model = fit_vspglm({y}, {x1(:, 2:end)}, {'log'});